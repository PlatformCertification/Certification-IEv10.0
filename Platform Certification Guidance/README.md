
# Platform Certification Guidance

## Contents <a name="Contents"/>
* 1. [OverView](#Over)<br>
  * 1.1. [ToolKit Architecture](#ToolKit)<br>
  * 1.2. [Detected Issues](#Detected)<br>
* 2. [Input](#Input)<br>
  * 2.1. [Certification Input Blocks](#Certification)<br>
    * 2.1.1. [Diagnosis Inputs Block](#Diagnosis)<br>
    * 2.1.2. [Diagnosis Function Block](#Dia)<br>
    * 2.1.3. [Global Settings Block](#Global)<br>
  * 2.2. [Certification Input Attributes Detail](#Certif)<br>
  * 2.3. [Certification Input Yaml Example](#Certifica)<br>
* 3. [Diagnosis List](#List)<br>
* 4. [Export Reports](#Reports)<br>
  * 4.1. [IP Error Report](#IP)<br>
    * 4.1.1. [Included columns](#In)<br>
    * 4.1.2. [Report Sample](#Rep)<br>
  * 4.2. [Device Error Report](#Device_Error_Report)<br>
    * 4.2.1. [Included columns](#Device_Error_ReportIn)<br>
    * 4.2.2. [Report Sample](#Device_Error_ReportRep)<br>
  * 4.3. [Interface Error Report](#Interface_Error_Report)<br>
    * 4.3.1. [Included columns](#Interface_Error_ReportIn)<br>
    * 4.3.2. [Report Sample](#Interface_Error_ReportRep)<br>
  * 4.4. [Enhanced Seed File](#Enhanced_Seed_File)<br>
    * 4.4.1. [Included columns](#Enhanced_Seed_FileIn)<br>
    * 4.4.2. [Report Sample](#Enhanced_Seed_FileRep)<br>
  * 4.5. [Change Zone list](#Change_Zone_list)<br>
    * 4.5.1. [Included columns](#Change_Zone_listIn)<br>
    * 4.5.2. [Report Sample](#Change_Zone_listRep)<br>
  * 4.6. [To be deleted devices](#tobedelete)<br>
    * 4.6.1. [Included columns](#tobedeleteIn)<br>
    * 4.6.2. [Report Sample](#tobedeleteRep)<br>
  * 4.7. [Not Qualified devices](#notqualified)<br>
    * 4.7.1. [Included columns](#notqualifiedIn)<br>
    * 4.7.2. [Report Sample](#notqualifiedRep)<br>
* 5. [NetBrain Library Generation From Diagnosis Inputs](#NetBrainLib)<br>
* 6. [Toolkit Operation Flow](#ToolkitFlow)<br>
* 7. [Route Map](#Route)<br>

## [Background](https://confluence.netbraintech.com/confluence/pages/viewpage.action?spaceKey=PD&title=Platform+Certification+Background)

### Current Issues
Currently, the Solution/Platform/R&D Team is based on cases to make up for the problems found by customers. In this mode, there will be the following problems:

1. Not enough resource solve the customer issues in time

2. Customer found the issue and may not be willing to share data/env

3. New technical support cannot be available to all customers

4. Manually discover and solve problems to extend the deployment/adoption time

5. Problem solving affects product impression after the customer finds it

### Solution
Based on the above-mentioned problems and data analysis, introduce the Platform Certification process to proactively found and solve data accuracy problems in the customer's network through a set of tools.

## 1. OverView <a name="Over"/>


### 1.1. ToolKit Architecture <a name="ToolKit"/>

**Certification Framework Architecture**

![OverallFlow](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/Certification-Framework.png)

The main purpose of platform certification plugin is apply the accuracy error detection for device, interface, topo and IPs data exist in NetBrain main DB which generated by NetBrain built-in discover and benchmark logic. 
For apply the correction, we must have a 100% accurate DB outside the NetBrain main DB as a reference to compare with NetBrain main DB. So during entire certification, the first half section is focus on build the 100% accurate reference DB(Digital Twin DB) by using pure network semantics(CLI Command by live parser and system table). After the Digital Twin DB(DT DB)generated successfully, "Comparator" will pull the same type of data from both DT DB and main DB to start the comparation precess. For duplicate IP issue, the fixing process will also be triggered and feed back the corrected data into main DB. And all other issues will be transfered to the problem DB to generated the final exported report.

**Certification Degital Twin Table Generate Sample**

![CommonTable](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/Certification-Sample.png)

### 1.2 Detected Issues <a name="Detected"/>
1. Duplicate IP Checking 
2. CLI Command Issue Incorrect  
3. Prompt Issue   
4. New Driver Issue  
5. New Format Issue  
6. SNMP Only 
7. SNMP No Support  
8. OID Incorrect  
9. Virtual System  
10. L2 Topology Checking 
11. L3 Topology Checking 
12. Configuration Failed  
13. Fixing by Add Zone

[***To Top***](#Contents)
    
## 2. Input <a name="Input"/>

### 2.1 Certification Input Blocks <a name="ToolCertificationKit"/>

#### 2.1.1. Diagnosis Inputs Block <a name="Diagnosis"/>
**diagnosis_inputs**<br>
Customer needs to insert all detail information for each certification which will be included in current plugin. Certification name, enable flag and all detail inputs must be inserted.

**diagnosis_inputs.inputs**<br>
As the most important section of certification_inputs, customer must review all attributes which belongs current component in [Certification Input Attributes Detail](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/Certification%20Input%20Attributes%20Detail.md). 

To define the input data source, the most important three sectoins are:
1. input_datas.parser<br>
Define one parser which will be considered as data source for current diagnosis function by using parser file path in NetBrain System. 
2. input_datas.system_table<br>
Define one system table which will be considered as data source for current diagnosis function by using system table name. 
3. variable_mapping<br>
Define column relationships between parser table and common table. 

After all desired data source have been inserted, customer need to take more care of the "qualification" section next, we provide three kinds of qualification methods totally:

1. qualification.gdr<br>
Represent the GDR which will be considered aSs a filter for devices, e.g. vendor name, device type, etc.
2. qualification.patterns<br>
Represent the config patterns which will be considered as a filter for daignosis data.
3. qualification.regexes<br>
Represent the regex rules which will be considered as a filter for diagnosis data.

If multiple qualification methods included, customer need to provide the boolean_expression in method level accurately to represent the relationship between each qualification method. Similar with point c, if customer provide multiple conditions in gdr_qulification, the boolean_expression in gdr_qulification level also need to be inserted accurately.

#### 2.1.2. Diagnosis Function Block <a name="Dia"/>

**diagnosis_functions**<br>
Customer need to pre-define desired detecting processes at this section which need to be triggered automatically to find platform related issues after plugin running successfully. For each fixing actions(all provided actions please check [Diagnosis List](#List) table), customer need to decide whether all listed diagnosis functions would be triggered during current plugin running. If one or few of the actions won't be triggered, customer just need to comment out the corresponding action name(s) from diagnosis_functions yaml section. Please check [Certification Input Attributes Detail](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/Certification%20Input%20Attributes%20Detail.md) for more information.

#### 2.1.3. Global Settings Block <a name="Global"/>
**global_settings**<br>
Customer need to insert all corresponding values for each attribute in this section. Please check Detail Introduction for more information.

### [2.2 Certification Input Attributes Detail](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/Certification%20Input%20Attributes%20Detail.md) <a name="Certif"/>
***Click on the title for detail information.***
    
### [2.3 Certification Input Yaml Example](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/Certification%20Input%20Example%20with%20Yaml.md) <a name="Certifica"/>
***Click on the title for built-in Yaml file.***

**Simplified Input Sample:**
```yaml
---
diagnosis_inputs:
- name: L3 Neighbor Data #'For diagnosis function: L3 Neighbor Checking, Duplicate IP Fixing'
  enable: true
  common_table_name: L3 Neighbor Data Common Table
  inputs:
  - name: System Table Inputs[All Vendors] # Name of current data input.
    input_datas:
    - parser: "Shared Files in Tenant/Certification Tool Parsers/OSPF Neighbors Detail [Cisco IOS]"
      system_table: ARP Table # parser or system_table can only have one in each input_datas block
      variable_mapping:
        Interface: Interface
        IP Address: Neighbor Interface IP
        MAC Address: Neighbor Interface MAC
        Area ID: Interface Area ID
      index_variables:
      - Interface
      - Interface IP
      extend_common_variables:
      - Interface Area ID
    qualification:
      gdr:
        conditions:
        - value: 'Cisco'
          operator: 4
          schema: subTypeName
        expression: A
      patterns:
      - "interface $str:intfName1"
      - "ip address $ip:ip1 $ip:mask1"
      regexes:
      - "regex:router ospf [0-9]+"
diagnosis_functions:
  - L3 Neighbor Checking # Report Missing/Wrong L3 topology, Missing Devices..
  - L2 Neighbor Checking # Report Missing/Wrong L2 topology, Missing Devices..
  - Duplicate IP Checking
  - Multi-Vendor Collection
  #- Duplicate IP Fixing
global_setting:
  white_ip_list: []
  enable_whilte_ip_list: true
  debug_options:
    log_level: 3
    build_common_table_from_inputs: true
    build_digital_twin: true
    run_diagnosis: true
    use_parser_cache_data: false
```

[***To Top***](#Contents)

## 3. Diagnosis List <a name="List"/>
| Diagnosis Name | Diagnosis Target | Available System Table (Available Columns) |
| --- | --- | --- |
|[L3 Neighbor Checking](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/L3%20Neighbor%20Checking.md) | 1. Detecting all L3 missing devices in customer legacy network. |1. L3 Neighbor Data Common Table ***(Device, Interface, Interface Area ID, Neighbor IP, Neighbor MAC)***<br>2. Interface Data Common Table ***(dev, intf, mac, ip)***|
|[L2 Neighbor Checking](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/L3%20Neighbor%20Checking.md) | 1. Detecting all L2 missing devices in customer legacy network. |1. L2 Neighbor Data Common Table ***(Interface, Neighbor Interface IP, Neighbor Interface, Neighbor Device, Neighbor Interface MAC)***|
|[Enhanced Seed IP Checking](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/Enhanced%20Seed%20IP%20Checking.md)| 1. Detecting all missing IPs  in customer legacy network.|1. L3 Neighbor Data Common Table ***(Device, Interface, Interface Area ID, Neighbor IP, Neighbor MAC)***<br>2. Interface Data Common Table ***(dev, intf, mac, ip)***<br> 3. L2 Neighbor Data Common Table ***(Interface, Neighbor Interface IP, Neighbor Interface, Neighbor Device, Neighbor Interface MAC)***|
|Duplicate IP Checking | 1. Detecting all duplicate IPs in customer NetBrain processing domain after discovery all legacy devices. |
|Fix Duplicate IP | 1. By detect all existing duplicate IP interfaces. <br>2. Base on the data source in Digital Twin DB which generated rely on the diagnosis inputs customer provided. <br>  3. Set device name, interface name and interface IP as search key to find L3 Topo records and separate IPs into different groups per L3 Topo. <br> 4. Then assign the duplicate IPs into different zones per L3 Topo groups.|
|Multi-Vendor Collection| 1. Collecting customer vendor capacity. <br>2. Checking supported vendors per built in driver. <br>3. Generating reports for further analysis.|
|Fixing LAN Subnet Issue |   1. Base on data source from digital twin DB. <br> 2. Separate neighbor pair into groups. <br> 3. Filter out duplicate subnet. <br> 4. Compare the duplicate subnet and group interface information with the subnet and interface info in  Netbrain DB, then separate the subnet MP L3 topology. |

[***To Top***](#Contents)

## 4. Export Reports <a name="Reports"/>

### 4.1 IP Error Report <a name="IP"/>
 
#### 4.1.1 Included columns <a name="In"/>
**IP:** the IPs which will be considered as duplicate IPs. <br> **ErrorCode Message:** the massage to describe the corresponding error code.<br> **ErrorCode:** the error code which occurred by current IP.<br> **Source Device:** the device which current IP belongs to.<br> **CLI Command:** the CLI command which retrieve the current IP information.

#### 4.1.2 Report Sample <a name="Rep"/>

![IPreport](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/report%20sample.png)

### 4.2 Device Error Report <a name="Device_Error_Report"/>
 
#### 4.2.1 Included columns  <a name="Device_Error_ReportIn"/>
**Device:** the device hostname of current device which facing errors. <br> **ErrorCode Message:** the massage to describe the corresponding error code. <br> **ErrorCode:** the error code which occurred by current IP. <br> **CLI Command:** the CLI command which retrieve the current IP information. <br> **In Baseline:** the corresponding represent value in NetBrain system of current device. <br> **In Digital Twin:** the corresponding represent value in platform certification process of current device.

#### 4.2.2 Report Sample <a name="Device_Error_ReportRep"/>

![Devicereport](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/Device%20Error%20Report.png)

### 4.3 Interface Error Report <a name="Interface_Error_Report"/>
 
#### 4.3.1 Included columns <a name="Interface_Error_ReportIn"/>
**Device:** the device hostname of current device. <br> **Interface:** the interface name of current interface which facing errors. <br> **ErrorCode Message:** the massage to describe the corresponding error code. <br> **ErrorCode:** the error code which occurred by current IP. <br> **CLI Command:** the CLI command which retrieve the current IP information. <br> **In Baseline:** the corresponding represent value in NetBrain system of current device. <br> **In Digital Twin:** the corresponding represent value in platform certification process of current device.

#### 4.3.2 Report Sample <a name="Interface_Error_ReportRep"/>

![InterfacePreport](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/Interface%20Error%20Report.png)

### 4.4 Enhanced Seed File（To be Discovered） <a name="Enhanced_Seed_File"/>
 
#### 4.4.1 Included columns <a name="Enhanced_Seed_FileIn"/>
**IP List:** IPs which can be considered as a network device IP from device data( e.g. Routing table ) but only can be found in Unknown IP List.<br>
**Source Information:** the data source where certification can detect this IP address.<br>
**Reason:** The reason why this IP address should be enhanced.

#### 4.4.2 Report Sample <a name="Enhanced_Seed_FileRep"/>

![SeedPreport](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/enhanced%20seed%20file.png)

### 4.5 Change Zone list <a name="Change_Zone_list"/>
 
#### 4.5.1 Included columns <a name="Change_Zone_listIn"/>
**IP Subnet:** the IP subnet info which has been detected. <br> **Device:** the device hostname of current device which the IP subnet belongs to. <br> **Interface:** name of the interface which associate with current IP subnet. <br> **Interface IPMASK:** the IPMASK information of current interface. <br> **Source:** Represent the current IP Subnet detected from Duplicate IP Checking or Duplicate Subnet Checking.<br> **Zone Name:** name of the zone which the current IP subnet belongs to.

#### 4.5.2 Report Sample <a name="Change_Zone_listRep"/>

![ZonePreport](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/Change%20Zone%20list.png)

### 4.6 To be deleted devices <a name="tobedelete"/>
 
#### 4.6.1 Included columns <a name="tobedeleteIn"/>
**Device:** the hostname of current device<br>**Management IP:** the management Ip of current device.<br>**Device Type:** the device type of current device.<br>**Vendor and Model:** vender and model information of current device.<br>**SysObjectID:** the SysObjectID value of current device.<br>**Last Access Succeed Time:** the last time point for NetBrain succeed to access(by Discover, Benchmark, Tune Live Access, Qapp, Live Path or any other live access method) to current device .<br>**Last Check Time:** the last time point for NetBrain failed to access to current device.<br>

#### 4.6.2 Report Sample <a name="tobedeleteRep"/>

![tobedelete](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/To%20be%20Deleted%20Device.png)

### 4.7 Not Qualified devices <a name="notqualified"/>
 
#### 4.7.1 Included columns <a name="notqualifiedIn"/>
**Device:** the hostname of current device<br>**Device Type:** the device type of current device.<br>**Vendor and Model:** vender and model information of current device.<br>**Driver Name:** the corresponding driver which will be triggered when discover this device.

#### 4.7.2 Report Sample <a name="notqualifiedRep"/>

![tobedelete](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/NotQualifieddevice.png)

***For detail information about ErrorCode, please click [here](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/Reports%20Error%20Code%20Detail.md).***

[***To Top***](#Contents)

## 5. NetBrain Library Generation From Diagnosis Inputs <a name="NetBrainLib"/>

Due to the Diagnosis Input structure we have defined now, it is very flexible and with a strong scalability. The purpose is we expect the original diagnosis input can be recursively extended by each engineer who has using it to diagnosis customer NetBrain system. Each customer would have unique legacy network conditions and the diagnosis inputs would be modified, enhanced and updated for accurately coincide with customer network phenomenon. With more and more different diagnosis inputs we can get from customer, after we merge all these inputs together, a general comprehensive almighty NetBrain Library would be grew up:

![NetBrainLibrary](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/images/MicrosoftTeams-image.png)

With the NetBrain Library enhanced, our engineers can much easier to find a corresponding diagnosis inputs template for new customer which means we can narrow down the involved Netbrain engineers numbers with new customer after we have enough inputs template in NetBrain Library. And also can reduce the meeting times with customer for collecting customer network info, trouble shooting unclassified diagnosis inputs and internal discussion. Which can speed up our Jumpstart program for new customer as we wished to involve Platform certification process into jumpstart program. 

[***To Top***](#Contents)

## [6. Toolkit Operation Flow](https://github.com/PlatformCertification/Certification-IEv10.0/blob/main/Platform%20Certification%20Guidance/Toolkit%20Operation%20Flow.md) <a name="ToolkitFlow"/>
***Click on the title for detail information.***


## 7. Route Map <a name="Route"/>
1. GDR Checking
2. Table Checking
3. Dry run path logic

[***To Top***](#Contents)
